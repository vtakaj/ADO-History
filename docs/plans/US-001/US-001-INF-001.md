# US-001-INF-001: シェルスクリプト基本構造作成

## Task Overview
ado-tracker.shシェルスクリプトの基本構造、メイン関数、コマンドライン引数処理を実装する。

## Acceptance Criteria
- [x] 実行可能なシェルスクリプトファイルの作成
- [x] コマンドライン引数解析機能
- [x] メイン処理フローの実装
- [x] 使用方法（usage）の表示機能
- [x] 基本的なバリデーション機能
- [x] エラー時の適切な終了コード設定

## Technical Requirements
- bash shebang（#!/bin/bash）の設定
- set -euo pipefail による厳密モード
- 引数チェックと使用方法表示
- 関数ベースの構造化プログラミング
- 終了コードの適切な管理

## Implementation Details
現行実装は `ado-tracker.sh` をエントリーポイントにし、各コマンドは `lib/commands/` 配下に分割されています。usage は以下の通りです。
```bash
Usage: ado-tracker.sh <command> [options]

Commands:
  fetch [project] [days] [--with-details]  チケット履歴とステータス変更履歴を取得
  status-history [project]                 ステータス変更履歴のみを取得
  fetch-details [project]                  Work Item詳細情報のみを取得
  generate-work-table <YYYY-MM> <file>     月次作業記録テーブル（マークダウン）を生成
  test-connection                          API接続テストを実行
  test-connection --mock                   モック環境でAPI機能をテスト
  config [show|validate|template]          設定管理
  help                                     このヘルプを表示
```

## File Structure
```
ado-tracker.sh             # エントリーポイント（コマンドルーター）
lib/
├── core/                  # API クライアント、設定、データ処理、ログ
├── commands/              # サブコマンド実装
├── formatters/            # 表示/Markdown 出力
└── utils/                 # 日付・文字列・ファイル・バリデーション
```

## Validation Features
```bash
# 引数バリデーション
validate_project_name() {
    local project="$1"
    
    if [[ -z "$project" ]]; then
        echo "Error: プロジェクト名を指定してください" >&2
        echo "ヒント: AZURE_DEVOPS_PROJECT を設定すると省略できます" >&2
        return 1
    fi
    
    if [[ ! "$project" =~ ^[a-zA-Z0-9_-]+$ ]]; then
        echo "Error: プロジェクト名に無効な文字が含まれています" >&2
        return 1
    fi
}

# 数値バリデーション
validate_days() {
    local days="$1"
    
    if [[ ! "$days" =~ ^[0-9]+$ ]] || [[ "$days" -lt 1 ]] || [[ "$days" -gt 365 ]]; then
        echo "Error: 日数は1-365の範囲で指定してください" >&2
        return 1
    fi
}
```

## Exit Codes
- 0: 正常終了
- 1: 引数エラー・一般的なエラー
- 2: 設定エラー
- 3: API接続エラー
- 4: ファイルI/Oエラー

## Definition of Done
- [x] chmod +x で実行可能なシェルスクリプトが作成される
- [x] --help でusageが表示される
- [x] 不正な引数で適切なエラーメッセージが表示される
- [x] 基本的なコマンド構造が実装される
- [x] エラー時に適切な終了コードが返される

## Dependencies
なし（最初に実装するタスク）

## Estimated Effort
2 hours

## Testing Strategy
- 引数なしでの実行テスト
- --help オプションのテスト
- 不正なコマンドでのエラーテスト
- 実行権限の確認
